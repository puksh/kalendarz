const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-rgIH9GXZ.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/PeopleListWindow-CfnnDtOr.js","assets/utils-DJFvb6CW.js","assets/vue-vendor-CpCnBria.js","assets/data-rJbXcCzs.js","assets/utils-DPnYpszc.css","assets/PeopleListWindow-DLDKi6TV.css","assets/ShiftCountWindow-CEcOQS7q.js","assets/ShiftCountWindow-CuA0xAoS.css","assets/AuthorizationModal-BT_Z7TNA.js","assets/AuthorizationModal-Chi4loWg.css","assets/CalendarComponent-Eis1YuzN.js","assets/scrollUtils-DOgAIRxg.js","assets/CalendarComponent-BlHco-79.css","assets/ExcelComponent-DeyaPCMS.js","assets/ExcelComponent-D20d5WXR.css"])))=>i.map(i=>d[i]);
import{e as U,c as M,o as E,d,b as Y,t as P,f as F,g as _,n as x,h as C,i as v,m as X,j as I,k as O,l as L,p as j,F as K,q as B,s as q}from"./vue-vendor-CpCnBria.js";import{M as A,_ as k,a as b,c as Z}from"./utils-DJFvb6CW.js";import"./data-rJbXcCzs.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const $="modulepreload",J=function(e){return"/"+e},z={},y=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){let l=function(h){return Promise.all(h.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),g=a?.nonce||a?.getAttribute("nonce");o=l(n.map(h=>{if(h=J(h),h in z)return;z[h]=!0;const u=h.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":$,u||(f.as="script"),f.crossOrigin="",f.href=h,g&&f.setAttribute("nonce",g),document.head.appendChild(f),u)return new Promise((S,r)=>{f.addEventListener("load",S),f.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return o.then(l=>{for(const a of l||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})},Q=U({name:"ButtonSwitchView",props:{currentComponent:{type:String,required:!0,validator:e=>["CalendarComponent","ExcelComponent"].includes(e)}},data(){return{MESSAGES:A}}}),ee=["title","aria-label"],te=["title","aria-label"];function ne(e,t,n,i,o,s){return e.currentComponent==="ExcelComponent"?(E(),M("button",{key:0,onClick:t[0]||(t[0]=l=>e.$emit("navigate","CalendarComponent")),class:"switch-view-button",title:e.MESSAGES.VIEW_SWITCH_TO_CALENDAR,"aria-label":e.MESSAGES.VIEW_SWITCH_TO_CALENDAR},[t[2]||(t[2]=d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor","stroke-width":"3"},[d("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"}),d("line",{x1:"3",y1:"10",x2:"21",y2:"10"}),d("line",{x1:"9",y1:"4",x2:"9",y2:"22"})],-1)),Y(" "+P(e.MESSAGES.VIEW_CALENDAR_TEXT),1)],8,ee)):(E(),M("button",{key:1,onClick:t[1]||(t[1]=l=>e.$emit("navigate","ExcelComponent")),class:"switch-view-button",title:e.MESSAGES.VIEW_SWITCH_TO_TABLE,"aria-label":e.MESSAGES.VIEW_SWITCH_TO_TABLE},[t[3]||(t[3]=F('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="3" data-v-d19d8b04><rect x="3" y="3" width="18" height="18" rx="2" data-v-d19d8b04></rect><line x1="3" y1="9" x2="21" y2="9" data-v-d19d8b04></line><line x1="3" y1="15" x2="21" y2="15" data-v-d19d8b04></line><line x1="9" y1="3" x2="9" y2="21" data-v-d19d8b04></line><line x1="15" y1="3" x2="15" y2="21" data-v-d19d8b04></line></svg>',1)),Y(" "+P(e.MESSAGES.VIEW_TABLE_TEXT),1)],8,te))}const V=k(Q,[["render",ne],["__scopeId","data-v-d19d8b04"]]),oe={},se={class:"refresh-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"};function ie(e,t){return E(),M("svg",se,t[0]||(t[0]=[d("path",{d:"M23 4v6h-6"},null,-1),d("path",{d:"M1 20v-6h6"},null,-1),d("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10"},null,-1),d("path",{d:"M20.49 15a9 9 0 0 1-14.85 3.36L1 14"},null,-1)]))}const G=k(oe,[["render",ie],["__scopeId","data-v-11885e2d"]]);function re(e){const t=[{date:new Date(e,0,1),name:"Nowy Rok"},{date:new Date(e,0,6),name:"Święto Trzech Króli"},{date:new Date(e,4,1),name:"Święto Pracy"},{date:new Date(e,4,3),name:"Święto Konstytucji 3 Maja"},{date:new Date(e,7,15),name:"Wniebowzięcie Najświętszej Maryi Panny"},{date:new Date(e,10,1),name:"Wszystkich Świętych"},{date:new Date(e,10,11),name:"Święto Niepodległości"},{date:new Date(e,11,25),name:"Boże Narodzenie (pierwszy dzień)"},{date:new Date(e,11,26),name:"Boże Narodzenie (drugi dzień)"}],n=ae(e);t.push({date:n,name:"Wielkanoc"});const i=new Date(n);i.setDate(n.getDate()+1),t.push({date:i,name:"Poniedziałek Wielkanocny"});const o=new Date(n);o.setDate(n.getDate()+49),t.push({date:o,name:"Zielone Świątki"});const s=new Date(n);return s.setDate(n.getDate()+60),t.push({date:s,name:"Boże Ciało"}),t}function ae(e){const t=e%19,n=Math.floor(e/100),i=e%100,o=Math.floor(n/4),s=n%4,l=Math.floor((n+8)/25),a=Math.floor((n-l+1)/3),g=(19*t+n-o-a+15)%30,h=Math.floor(i/4),u=i%4,m=(32+2*s+2*h-g-u)%7,f=Math.floor((t+11*g+22*m)/451),S=Math.floor((g+m-7*f+114)/31)-1,r=(g+m-7*f+114)%31+1;return new Date(e,S,r)}function T(e){const t=re(e.getFullYear()),n=e.toDateString();for(const i of t)if(i.date.toDateString()===n)return{isHoliday:!0,name:i.name};return{isHoliday:!1}}const le=e=>["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"][e],de=e=>{let t=e,n="",i;for(;t>0;)i=(t-1)%26,n=String.fromCharCode(65+i)+n,t=Math.floor((t-i)/26);return n},ce=(e,t,n=`
`)=>{const i=t.toDateString(),o=sessionStorage.getItem(i);if(o){const s=JSON.parse(o),l=[];return(s?.dayShift1===e||s?.dayShift2===e)&&l.push("D"),(s?.nightShift1===e||s?.nightShift2===e)&&l.push("N"),l.join(n)}return""},he=e=>{const t=e.getDay();return t===0||t===6?!0:T(e).isHoliday},ue=(e,t)=>{const n=document.createElement("a"),i=URL.createObjectURL(e);n.setAttribute("href",i),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)},pe=e=>{let t="";const n=new Uint8Array(e);for(let i=0;i<n.byteLength;i++)t+=String.fromCharCode(n[i]);return window.btoa(t)},fe={name:"ButtonExport",props:{people:{type:Array,required:!0},monthDays:{type:Array,required:!0},selectedMonth:{type:Number,required:!0},selectedYear:{type:Number,required:!0},currentPage:{type:String,default:"ExcelComponent"}},data(){return{showExportMenu:!1,isMobileView:!1,MESSAGES:A}},mounted(){document.addEventListener("click",this.handleOutsideClick),this.checkMobileView(),window.addEventListener("resize",this.checkMobileView)},beforeUnmount(){document.removeEventListener("click",this.handleOutsideClick),window.removeEventListener("resize",this.checkMobileView)},methods:{toggleExportMenu(e){e.stopPropagation(),this.showExportMenu=!this.showExportMenu},handleOutsideClick(e){this.showExportMenu&&!e.target.closest(".export-container")&&(this.showExportMenu=!1)},getMonthName(){return le(this.selectedMonth)},getFilename(e){return`${this.MESSAGES.EXPORT_FILENAME_PREFIX}${this.getMonthName()}_${this.selectedYear}.${e}`},exportToCsv(){let e="\uFEFF";e+="Imię";for(let n=1;n<=this.getDaysInMonth();n++)e+=`;${n}`;e+=`\r
`;for(const n of this.people){e+=`"${n.name}"`;for(let i=1;i<=this.getDaysInMonth();i++)e+=`;${this.getFormattedShift(n.id,i," ")||""}`;e+=`\r
`}const t=new Blob([e],{type:"text/csv;charset=utf-8"});ue(t,this.getFilename("csv")),this.showExportMenu=!1},async exportToPdf(){try{const{jsPDF:e}=await y(async()=>{const{jsPDF:r}=await import("./jspdf.es.min-DgdMWQzs.js").then(c=>c.j);return{jsPDF:r}},[]),{autoTable:t}=await y(async()=>{const{autoTable:r}=await import("./jspdf.plugin.autotable-BgrBGiiK.js");return{autoTable:r}},[]),n=new e({orientation:"landscape",unit:"mm",format:"a4"});try{const r=await fetch("/assets/fonts/IBMPlexMono-Regular.ttf");if(!r.ok)throw new Error("Font file not found");const c=await r.arrayBuffer();n.addFileToVFS("IBMPlexMono-Regular.ttf",pe(c)),n.addFont("IBMPlexMono-Regular.ttf","IBMPlexMono","normal"),n.setFont("IBMPlexMono")}catch(r){console.warn("Could not load local font, using fallback",r),n.setFont("helvetica")}let i=n.internal.pageSize.getWidth();n.setFontSize(16),n.setTextColor(0,0,0);const o="IZBA PRZYJĘĆ DZIECIĘCA",s=n.getStringUnitWidth(o)*n.getFontSize()/n.internal.scaleFactor;n.text(o,(i-s)/2,15);const a="ROZKŁAD PRACY PRACOWNIKÓW KONTRAKTOWYCH - {0} {1}r.".replace("{0}",this.getMonthName()).replace("{1}",this.selectedYear),g=n.getStringUnitWidth(a)*n.getFontSize()/n.internal.scaleFactor;n.text(a,(i-g)/2,22);const h=["Imię"];for(let r=1;r<=this.getDaysInMonth();r++)h.push(r.toString());const u=this.people.map(r=>{const c=[r.name];for(let p=1;p<=this.getDaysInMonth();p++){const w=this.getFormattedShift(r.id,p,`
`);c.push(w||"")}return c});t(n,{head:[h],body:u,startY:30,theme:"grid",margin:{left:8},styles:{fontSize:8,cellPadding:3,font:"IBMPlexMono",fontStyle:"normal",lineWidth:.3,minCellHeight:8,halign:"center",cellWidth:"wrap",overflow:"linebreak"},columnStyles:{0:{cellWidth:24}},headStyles:{fillColor:[0,62,62],textColor:[255,255,255],fontSize:6},didParseCell:function(r){try{if(r.section==="head"&&r.row.index===0&&r.column.index>0){const c=parseInt(r.cell.raw.toString());if(!isNaN(c)){const p=new Date(this.selectedYear,this.selectedMonth,c),w=p.getDay(),D=w===6,R=w===0;T(p).isHoliday?(r.cell.styles.fillColor=[255,255,255],r.cell.styles.textColor=[204,0,0]):D?(r.cell.styles.fillColor=[0,153,0],r.cell.styles.textColor=[255,255,255]):R&&(r.cell.styles.fillColor=[204,0,0],r.cell.styles.textColor=[255,255,255])}}else if(r.section==="body"&&(r.row.index%2===1?r.cell.styles.fillColor=[240,240,240]:r.cell.styles.fillColor=[255,255,255],r.column.index>0)){const c=parseInt(r.cell.raw.toString());if(!isNaN(c)){const p=new Date(this.selectedYear,this.selectedMonth,c),w=p.getDay(),D=w===6,R=w===0;T(p).isHoliday?r.cell.styles.fillColor=[255,238,238]:(D||R)&&(r.cell.styles.fillColor=[235,235,235])}}}catch(c){console.error("Error in didParseCell:",c)}}.bind(this),didDrawCell:function(r){try{if(r.section==="head"&&r.row.index===0&&r.column.index>0){const c=parseInt(r.cell.raw.toString());if(!isNaN(c)){const p=new Date(this.selectedYear,this.selectedMonth,c);if(T(p).isHoliday){const{x:D,y:R,width:N}=r.cell;n.setFontSize(6),n.setTextColor(204,0,0),n.text("*",D+N-3,R+3),n.setFontSize(8),n.setTextColor(0,0,0)}}}}catch(c){console.error("Error in didDrawCell:",c)}}.bind(this)});const f=(n.lastAutoTable.finalY||150)+10;n.setFontSize(10),n.setTextColor(0,0,0),n.text(this.MESSAGES.EXPORT_LEGEND,14,f),n.text(this.MESSAGES.EXPORT_LEGEND_DAY_SHIFT,14,f+6),n.text(this.MESSAGES.EXPORT_LEGEND_NIGHT_SHIFT,14,f+12),n.text(this.MESSAGES.EXPORT_LEGEND_FULL_DAY_SHIFT,14,f+18);const S=[];for(let r=1;r<=this.getDaysInMonth();r++){const c=new Date(this.selectedYear,this.selectedMonth,r),p=T(c);p.isHoliday&&S.push({date:c,name:p.name})}S.length!=0&&(n.text(this.MESSAGES.EXPORT_HOLIDAYS_THIS_MONTH,14,f+28),S.forEach((r,c)=>{n.text(`${r.date.getDate()} - ${r.name}`,14,f+34+c*6)})),n.save(this.getFilename("pdf")),this.showExportMenu=!1,b(this.MESSAGES.EXPORT_PDF_SUCCESS,"green")}catch(e){console.error("Error exporting PDF:",e),b(this.MESSAGES.EXPORT_PDF_ERROR,"red")}},async exportToExcel(){try{const e=await y(()=>import("./exceljs.min-rgIH9GXZ.js").then(a=>a.e),__vite__mapDeps([0,1])),t=new e.Workbook,n=t.addWorksheet(`${this.getMonthName()} ${this.selectedYear}`),i=["Imię"];for(let a=1;a<=this.getDaysInMonth();a++)i.push(a.toString());n.addRow(i);const o=n.getRow(1).eachCell(a=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"003E3E"}},a.font={color:{argb:"FFFFFF"},bold:!0},a.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}});this.people.forEach((a,g)=>{const h=[a.name];for(let m=1;m<=this.getDaysInMonth();m++)h.push(this.getFormattedShift(a.id,m," "));n.addRow(h);const u=g+2;u%2===0&&n.getRow(u).eachCell(m=>{m.fill={type:"pattern",pattern:"solid",fgColor:{argb:"F0F0F0"}}})});for(let a=1;a<=this.getDaysInMonth();a++){const g=new Date(this.selectedYear,this.selectedMonth,a),{isHoliday:h,name:u}=T(g),m=g.getDay(),f=m===6,S=m===0;if(f||S||h){const c=de(a+1);for(let w=2;w<=this.people.length+1;w++){const D=n.getCell(`${c}${w}`);D.fill={type:"pattern",pattern:"solid",fgColor:{argb:h?"FFEEEE":"EEEEEE"}}}const p=n.getCell(`${c}1`);if(h){p.note=u;const w=p.value?.toString()||"";p.value=w+this.MESSAGES.EXPORT_EXCEL_HOLIDAY_INDICATOR,p.font={color:{argb:"FFCC0000"},bold:!0}}else f?(p.fill={type:"pattern",pattern:"solid",fgColor:{argb:"009900"}},p.font={color:{argb:"FFFFFF"},bold:!0}):S&&(p.fill={type:"pattern",pattern:"solid",fgColor:{argb:"CC0000"}},p.font={color:{argb:"FFFFFF"},bold:!0})}}n.columns.forEach(a=>{a.width=12}),n.getColumn(1).width=20,n.getColumn(1).alignment={horizontal:"left"};const s=await t.xlsx.writeBuffer(),l=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});this.downloadFile(l,this.getFilename("xlsx")),this.showExportMenu=!1,b(this.MESSAGES.EXPORT_EXCEL_SUCCESS,"green")}catch(e){console.error("Error exporting Excel:",e),b(this.MESSAGES.EXPORT_EXCEL_ERROR,"red")}},downloadFile(e,t){const n=document.createElement("a"),i=URL.createObjectURL(e);n.setAttribute("href",i),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)},getDaysInMonth(){return new Date(this.selectedYear,this.selectedMonth+1,0).getDate()},getFormattedShift(e,t,n=`
`){const i=new Date(this.selectedYear,this.selectedMonth,t);return ce(e,i,n)},isWeekendOrHoliday(e){const t=new Date(this.selectedYear,this.selectedMonth,e);return he(t)},checkMobileView(){this.isMobileView=window.innerWidth<=768}}},me={class:"export-container"},ge=["title","aria-label"];function Ee(e,t,n,i,o,s){return E(),M("div",me,[d("button",{class:x(["export-button top-right-buttons",{"excel-position":n.currentPage==="ExcelComponent","calendar-position":n.currentPage==="CalendarComponent"}]),onClick:t[0]||(t[0]=(...l)=>s.toggleExportMenu&&s.toggleExportMenu(...l)),title:o.MESSAGES.EXPORT_SCHEDULE_TITLE,"aria-label":o.MESSAGES.EXPORT_SCHEDULE_ARIA},t[4]||(t[4]=[d("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"export-icon"},[d("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),d("polyline",{points:"7 10 12 15 17 10"}),d("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1)]),10,ge),o.showExportMenu?(E(),M("div",{key:0,class:x(["export-menu",[{"excel-position":n.currentPage==="ExcelComponent","calendar-position":n.currentPage==="CalendarComponent"},{"mobile-excel":n.currentPage==="ExcelComponent"&&o.isMobileView,"mobile-calendar":n.currentPage==="CalendarComponent"&&o.isMobileView}]])},[d("button",{onClick:t[1]||(t[1]=(...l)=>s.exportToCsv&&s.exportToCsv(...l)),class:"export-option"},[t[5]||(t[5]=F('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-db3f0195><path d="M14 3v4a1 1 0 0 0 1 1h4" data-v-db3f0195></path><path d="M17 21H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7l5 5v11a2 2 0 0 1-2 2z" data-v-db3f0195></path><path d="M9 17h6" data-v-db3f0195></path><path d="M9 13h6" data-v-db3f0195></path></svg>',1)),d("span",null,P(o.MESSAGES.EXPORT_FORMAT_CSV),1)]),d("button",{onClick:t[2]||(t[2]=(...l)=>s.exportToExcel&&s.exportToExcel(...l)),class:"export-option"},[t[6]||(t[6]=F('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="lightgreen" stroke-width="2" data-v-db3f0195><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-db3f0195></path><polyline points="14 2 14 8 20 8" data-v-db3f0195></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-db3f0195></line><line x1="16" y1="17" x2="8" y2="17" data-v-db3f0195></line><polyline points="10 9 9 9 8 9" data-v-db3f0195></polyline></svg>',1)),d("span",null,P(o.MESSAGES.EXPORT_FORMAT_EXCEL),1)]),d("button",{onClick:t[3]||(t[3]=(...l)=>s.exportToPdf&&s.exportToPdf(...l)),class:"export-option"},[t[7]||(t[7]=F('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="pink" stroke-width="2" data-v-db3f0195><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-db3f0195></path><polyline points="14 2 14 8 20 8" data-v-db3f0195></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-db3f0195></line><line x1="16" y1="17" x2="8" y2="17" data-v-db3f0195></line><polyline points="10 9 9 9 8 9" data-v-db3f0195></polyline></svg>',1)),d("span",null,P(o.MESSAGES.EXPORT_FORMAT_PDF),1)])],2)):_("",!0)])}const H=k(fe,[["render",Ee],["__scopeId","data-v-db3f0195"]]),we={name:"MonthSelector",props:{currentMonth:{type:Number,required:!0},currentYear:{type:Number,required:!0},locale:{type:String,default:"pl"},hasUnsavedChanges:{type:Boolean,default:!1}},data(){return{isChanging:!1,MESSAGES:A,minYear:2024,minMonth:10,maxYear:2025,maxMonth:8}},computed:{formattedMonthYear(){return new Date(this.currentYear,this.currentMonth).toLocaleString(this.locale,{month:"long",year:"numeric"}).toUpperCase()},canGoToPrevious(){const e=new Date(this.currentYear,this.currentMonth),t=new Date(this.minYear,this.minMonth);return e>t},canGoToNext(){const e=new Date(this.currentYear,this.currentMonth),t=new Date(this.maxYear,this.maxMonth);return e<t}},mounted(){document.addEventListener("keydown",this.handleKeyDown),this.validateCurrentDate()},beforeUnmount(){document.removeEventListener("keydown",this.handleKeyDown)},methods:{handleKeyDown(e){const t=document.activeElement;if(!(t&&(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)))switch(e.key){case"ArrowLeft":case"<":this.canGoToPrevious&&(e.preventDefault(),this.handleMonthChange(-1));break;case"ArrowRight":case">":this.canGoToNext&&(e.preventDefault(),this.handleMonthChange(1));break;case"PageUp":this.canGoToPrevious&&(e.preventDefault(),this.handleMonthChange(-1));break;case"PageDown":this.canGoToNext&&(e.preventDefault(),this.handleMonthChange(1));break;case"ArrowUp":if(e.ctrlKey||e.metaKey){const n=new Date(this.currentYear-1,this.currentMonth);this.isDateInRange(n.getFullYear(),n.getMonth())&&(e.preventDefault(),this.handleMonthChange(-12))}break;case"ArrowDown":if(e.ctrlKey||e.metaKey){const n=new Date(this.currentYear+1,this.currentMonth);this.isDateInRange(n.getFullYear(),n.getMonth())&&(e.preventDefault(),this.handleMonthChange(12))}break}},validateCurrentDate(){const e=new Date(this.currentYear,this.currentMonth),t=new Date(this.maxYear,this.maxMonth);if(e>t){const n=(this.maxYear-this.currentYear)*12+(this.maxMonth-this.currentMonth);this.$emit("change-month",n)}},isDateInRange(e,t){const n=new Date(e,t),i=new Date(this.minYear,this.minMonth),o=new Date(this.maxYear,this.maxMonth);return n>=i&&n<=o},handleMonthChange(e){const t=new Date(this.currentYear,this.currentMonth+e),n=t.getFullYear(),i=t.getMonth();if(this.isDateInRange(n,i)){if(this.hasUnsavedChanges){if(!confirm(A.MONTH_CHANGE_UNSAVED))return;this.$emit("discard-changes")}this.isChanging=!0,setTimeout(()=>{this.isChanging=!1},300),this.$emit("change-month",e)}}}},Me={class:"monthChange"},Se=["disabled","aria-label","title"],ye=["disabled","aria-label","title"];function Ce(e,t,n,i,o,s){return E(),M("section",Me,[d("button",{class:"buttonMonthChange prev-month",onClick:t[0]||(t[0]=l=>s.handleMonthChange(-1)),disabled:!s.canGoToPrevious,"aria-label":o.MESSAGES.MONTH_PREVIOUS,title:o.MESSAGES.MONTH_PREVIOUS_GO_TO}," ‹ ",8,Se),d("span",{class:x({changing:o.isChanging}),role:"heading","aria-level":"2"},P(s.formattedMonthYear),3),d("button",{class:"buttonMonthChange next-month",onClick:t[1]||(t[1]=l=>s.handleMonthChange(1)),disabled:!s.canGoToNext,"aria-label":o.MESSAGES.MONTH_NEXT,title:o.MESSAGES.MONTH_NEXT_GO_TO}," › ",8,ye)])}const W=k(we,[["render",Ce],["__scopeId","data-v-8c2fa0ed"]]),ve=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"})),be=U({name:"ButtonsTopBar",components:{ButtonSwitchView:V,RefreshIcon:G,ButtonExport:H,MonthSelector:W},props:{canSave:Boolean,currentComponent:String,currentMonth:Number,currentYear:Number,locale:String,hasUnsavedChanges:Boolean,isEditingMode:Boolean,isRefreshing:Boolean,people:Array,monthDays:Array},data(){return{isMenuOpen:!1,isMobileView:!1,MESSAGES:A}},methods:{checkMobileView(){this.isMobileView=window.innerWidth<=768,this.isMobileView||(this.isMenuOpen=!1)}},mounted(){this.checkMobileView(),window.addEventListener("resize",this.checkMobileView)},beforeUnmount(){window.removeEventListener("resize",this.checkMobileView)}}),De={class:"buttons-top-bar"},_e={class:"fixed-buttons"},xe=["aria-expanded"],Pe=["aria-label","title"];function ke(e,t,n,i,o,s){const l=C("MonthSelector"),a=C("ButtonSwitchView"),g=C("refresh-icon"),h=C("ButtonExport");return E(),M("nav",De,[d("div",_e,[e.isMobileView?(E(),M("button",{key:0,class:x(["hamburger-menu",{"is-open":e.isMenuOpen}]),onClick:t[0]||(t[0]=u=>e.isMenuOpen=!e.isMenuOpen),"aria-expanded":e.isMenuOpen,"aria-label":"Menu"},t[5]||(t[5]=[d("span",null,null,-1),d("span",null,null,-1),d("span",null,null,-1)]),10,xe)):_("",!0),v(l,{currentMonth:e.currentMonth,currentYear:e.currentYear,locale:e.locale,hasUnsavedChanges:e.hasUnsavedChanges,onChangeMonth:t[1]||(t[1]=u=>e.$emit("change-month",u)),onDiscardChanges:t[2]||(t[2]=u=>e.$emit("discard-changes"))},null,8,["currentMonth","currentYear","locale","hasUnsavedChanges"])]),d("div",{class:x(["collapsible-buttons",{"menu-open":e.isMenuOpen&&e.isMobileView,"mobile-view":e.isMobileView,"desktop-view":!e.isMobileView}])},[v(a,{currentComponent:e.currentComponent,onNavigate:t[3]||(t[3]=u=>e.$emit("navigate",u))},null,8,["currentComponent"]),d("div",{class:x(["right-buttons",{"mobile-view":e.isMobileView}])},[d("button",{class:"top-right-buttons buttonRefresh",onClick:t[4]||(t[4]=u=>e.$emit("refresh")),"aria-label":e.MESSAGES.REFRESH,title:e.MESSAGES.REFRESH},[v(g,{class:x({refreshing:e.isRefreshing})},null,8,["class"])],8,Pe),v(h,X(e.$attrs,{people:e.people,monthDays:e.monthDays,selectedMonth:e.currentMonth,selectedYear:e.currentYear,"current-page":e.currentComponent}),null,16,["people","monthDays","selectedMonth","selectedYear","current-page"])],2)],2)])}const Te=k(be,[["render",ke],["__scopeId","data-v-12582a06"]]),Ae={name:"SubmitButton",props:{canSave:{type:Boolean,required:!0}},emits:["save"],data(){return{MESSAGES:A}}},Re=["disabled","aria-label","title"];function Ie(e,t,n,i,o,s){return E(),M("button",{disabled:!n.canSave,onClick:t[0]||(t[0]=l=>e.$emit("save")),class:"submit-button","aria-label":o.MESSAGES.SAVE_CHANGES,title:o.MESSAGES.SAVE_CHANGES},P(o.MESSAGES.SAVE_BUTTON_TEXT),9,Re)}const Oe=k(Ae,[["render",Ie],["__scopeId","data-v-532d9e26"]]),Fe={name:"VueCalendar",components:{ButtonsTopBar:Te,ButtonSwitchView:V,SubmitButton:Oe,MonthSelector:I(()=>y(()=>Promise.resolve().then(()=>ve),void 0)),PeopleListWindow:I(()=>y(()=>import("./PeopleListWindow-CfnnDtOr.js"),__vite__mapDeps([2,3,4,5,6,7]))),ShiftCountWindow:I(()=>y(()=>import("./ShiftCountWindow-CEcOQS7q.js"),__vite__mapDeps([8,3,4,5,6,9]))),NotificationMessage:I(()=>y(()=>import("./utils-DJFvb6CW.js").then(e=>e.d),__vite__mapDeps([3,4,5,6]))),RefreshIcon:G,ButtonExport:H},data(){return{isLoading:!1,isEditingMode:!1,selectedMonth:new Date().getMonth(),selectedYear:new Date().getFullYear(),locale:"pl",hasUnsavedChanges:!1,showPasswordModal:!1,localData:{},people:[{id:1,name:"Milena",ratownik:!1},{id:2,name:"Mikołaj",ratownik:!1},{id:3,name:"Aleksandra",ratownik:!1},{id:4,name:"Łukasz",ratownik:!0},{id:5,name:"Joanna",ratownik:!1},{id:6,name:"Natalia",ratownik:!0},{id:7,name:"Marcin",ratownik:!0}],monthDays:[],isRefreshing:!1,AuthorizationModal:null,CalendarComponent:null,ExcelComponent:null,currentPage:this.safeGetFromStorage("currentPage","ExcelComponent")}},computed:{canSave(){return this.hasUnsavedChanges},peopleListEditingMode(){return this.currentPage==="CalendarComponent"&&this.isEditingMode},activeComponentRef(){return this.currentPage==="CalendarComponent"?this.$refs.calendarComponent:this.$refs.excelComponent}},methods:{showPasswordPrompt(){if(this.AuthorizationModal){this.showPasswordModal=!0;return}y(()=>import("./AuthorizationModal-BT_Z7TNA.js"),__vite__mapDeps([10,3,4,5,6,11])).then(e=>{this.AuthorizationModal=B(e.default),this.showPasswordModal=!0})},handleAuthorization(){this.showPasswordModal=!1,this.hasUnsavedChanges=!1},loadPageComponent(e){const n={CalendarComponent:()=>y(()=>import("./CalendarComponent-Eis1YuzN.js"),__vite__mapDeps([12,13,3,4,5,6,14])),ExcelComponent:()=>y(()=>import("./ExcelComponent-DeyaPCMS.js"),__vite__mapDeps([15,13,3,4,5,6,16]))}[e];return!n||this[e]?Promise.resolve():(this.isLoading=!0,n().then(i=>{this[e]=B(i.default)}).finally(()=>{this.isLoading=!1}))},handleNavigation(e){this.hasUnsavedChanges&&!confirm("Masz niezapisane zmiany. Czy na pewno chcesz zmienić widok?")||(localStorage.setItem("currentPage",e),this.loadPageComponent(e).then(()=>{this.currentPage=e,this.hasUnsavedChanges=!1}))},handleMonthChange(e){const t=new Date(this.selectedYear,this.selectedMonth,1);t.setMonth(t.getMonth()+e),this.selectedMonth=t.getMonth(),this.selectedYear=t.getFullYear()},discardChanges(){this.hasUnsavedChanges=!1,this.checkShiftDataSync()},generateCurrentView(){this.currentPage==="CalendarComponent"&&this.$refs.calendarComponent&&this.$refs.calendarComponent.generateMonthDays()},async checkShiftDataSync(){const e=new Error("Sync timeout");this.isRefreshing=!0;try{await Promise.race([Z(()=>this.activeComponentRef?.generateMonthDays()),new Promise((t,n)=>setTimeout(()=>n(e),5e3))]),this.hasUnsavedChanges=!1}catch(t){console.error(t),b(`Błąd podczas odświeżania: ${t.message}`,"red")}finally{setTimeout(()=>this.isRefreshing=!1,800)}},updateEditingMode(e){this.isEditingMode=!1,localStorage.setItem("isEditingMode",JSON.stringify(!1))},updateUnsavedChanges(e){this.hasUnsavedChanges=e},emitEditingMode(e){this.updateEditingMode(!1)},enableEditingMode(){this.isEditingMode=!1},updateMonthDays(e){this.monthDays=e},globalErrorHandler(){this.isRefreshing=!1,this.currentPage==="ExcelComponent"&&!this.$refs.excelComponent&&this.handleNavigation("ExcelComponent"),this.isLoading=!1},safeGetFromStorage(e,t){try{const n=localStorage.getItem(e);return n===null?t:e==="currentPage"?n:JSON.parse(n)}catch(n){return console.warn(`Error reading ${e} from localStorage:`,n),t}}},async mounted(){try{this.isRefreshing=!1,await this.loadPageComponent("ExcelComponent").catch(t=>{console.error("Failed to load Excel component:",t),b("Błąd ładowania Tabeli","red")}),localStorage.getItem("currentPage")==="CalendarComponent"&&await this.loadPageComponent("CalendarComponent").catch(t=>{console.error("Failed to load Calendar component:",t),b("Błąd ładowania Kalendarza","red"),this.currentPage="ExcelComponent",localStorage.setItem("currentPage","ExcelComponent")}),this.discardChanges(),this.hasUnsavedChanges=!1}catch(e){console.error("Error during application initialization:",e),b("Błąd inicjalizacji aplikacji","red")}["error","unhandledrejection"].forEach(e=>window.addEventListener(e,()=>this.globalErrorHandler()))}},Ne={class:"app-container"},Le={class:"main-content"},Ye={key:0,class:"refresh-overlay"};function Be(e,t,n,i,o,s){const l=C("SubmitButton"),a=C("ButtonsTopBar"),g=C("RefreshIcon"),h=C("PeopleListWindow"),u=C("ShiftCountWindow"),m=C("NotificationMessage");return E(),M(K,null,[d("div",Ne,[o.AuthorizationModal&&o.showPasswordModal?(E(),O(L(o.AuthorizationModal),{key:0,show:o.showPasswordModal,onClose:t[0]||(t[0]=f=>o.showPasswordModal=!1),onAuthorized:s.handleAuthorization,"aria-label":"Zapisz zmiany",title:"Zapisz zmiany w harmonogramie",mode:"save"},null,40,["show","onAuthorized"])):_("",!0),v(l,{canSave:s.canSave,onSave:s.showPasswordPrompt},null,8,["canSave","onSave"]),v(a,{canSave:s.canSave,currentComponent:o.currentPage,currentMonth:o.selectedMonth,currentYear:o.selectedYear,locale:o.locale,hasUnsavedChanges:o.hasUnsavedChanges,isEditingMode:o.isEditingMode,isRefreshing:o.isRefreshing,people:o.people,monthDays:o.monthDays,onSave:s.showPasswordPrompt,onNavigate:s.handleNavigation,onChangeMonth:s.handleMonthChange,onDiscardChanges:s.discardChanges,onRefresh:s.checkShiftDataSync,onHasChanges:s.updateUnsavedChanges},null,8,["canSave","currentComponent","currentMonth","currentYear","locale","hasUnsavedChanges","isEditingMode","isRefreshing","people","monthDays","onSave","onNavigate","onChangeMonth","onDiscardChanges","onRefresh","onHasChanges"]),d("main",Le,[o.isRefreshing?(E(),M("div",Ye,[v(g,{class:"centered-refresh-icon refreshing"})])):_("",!0),d("div",{class:"component-wrapper",style:j({opacity:o.isRefreshing?"0.5":"1"})},[o.currentPage==="CalendarComponent"?(E(),O(L(o.CalendarComponent),{key:0,ref:"calendarComponent",isEditingMode:o.isEditingMode,selectedMonth:o.selectedMonth,selectedYear:o.selectedYear,people:o.people,onUpdateEditingMode:s.updateEditingMode,onHasChanges:s.updateUnsavedChanges,onMonthDaysUpdated:s.updateMonthDays},null,40,["isEditingMode","selectedMonth","selectedYear","people","onUpdateEditingMode","onHasChanges","onMonthDaysUpdated"])):_("",!0),o.currentPage==="ExcelComponent"?(E(),O(L(o.ExcelComponent),{key:1,ref:"excelComponent",isEditingMode:o.isEditingMode,selectedMonth:o.selectedMonth,selectedYear:o.selectedYear,people:o.people,onUpdateEditingMode:s.updateEditingMode,onHasChanges:s.updateUnsavedChanges,onMonthDaysUpdated:s.updateMonthDays},null,40,["isEditingMode","selectedMonth","selectedYear","people","onUpdateEditingMode","onHasChanges","onMonthDaysUpdated"])):_("",!0)],4),v(h,{people:o.people,isEditingMode:s.peopleListEditingMode},null,8,["people","isEditingMode"]),o.monthDays.length>0&&o.localData[1]!==null?(E(),O(u,{key:1,ref:"shiftCountWindow",people:o.people,monthDays:o.monthDays},null,8,["people","monthDays"])):_("",!0),v(m)])]),t[1]||(t[1]=d("footer",{class:"footer"},[d("a",{href:"https://github.com/puksh/kalendar"},"© 2025 puksh - All rights reserved")],-1))],64)}const ze=k(Fe,[["render",Be],["__scopeId","data-v-dc826578"]]);window.addEventListener("error",e=>{e.error&&(e.error.message.includes("Failed to fetch dynamically imported module")||e.error.message.includes("Importing a module script failed"))&&window.location.reload()});q(ze).mount("#app");"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(e=>{console.log("Service Worker registered with scope:",e.scope)}).catch(e=>{console.log("Service Worker registration failed:",e)})});export{y as _,ce as g,T as i};
